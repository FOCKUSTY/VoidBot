const { SlashCommandBuilder, EmbedBuilder, Client, GatewayIntentBits } = require('discord.js');
const guildChannelsId = []
const client = new Client({
	intents: [
	GatewayIntentBits.Guilds,
	GatewayIntentBits.GuildMessages,
	GatewayIntentBits.DirectMessages,
	GatewayIntentBits.MessageContent,
]});

module.exports = {
    data: new SlashCommandBuilder()
	.setName('channle')
	.setDescription('Все каналы !'),
    async execute(interaction) {

        console.log(client.channels)

        client.channels.cache.forEach(TextChannel => {
            var TextChannelId = TextChannel.id
            var TextChannelName = TextChannel.name
            var TextChannelGuildId = TextChannel.guildId
            var TextChannelGuild = TextChannel.guild
            guildChannelsId.push(`\n${TextChannelId}/${`${TextChannelName}`.slice(0, 8)}-${`${TextChannelGuildId}`.slice(0, 2)}${`${TextChannelGuild}`.slice(0, 5)}`)
          })

        await interaction.reply(`# :tophat:\n## Ищем информацию...`, {ephemeral: true})

        for(i = 0; i < guildChannelsId.length; i += 100){
            const embed = new EmbedBuilder()
                .setColor(0x161618)
                .setTitle('Информация с серверов')
                .setAuthor({ name: `Bottomless Hat`, iconURL: `https://cdn.discordapp.com/icons/1053295032762908782/c349d0ecbd2d23859aba5b0f7bbec1ae.png` })
                .setDescription(`\`\`\`${guildChannelsId.slice(0 + i, 100 + i)}\`\`\``)
                await interaction.followUp({
                    content: ``,
                    embeds: [embed],
                    ephemeral: true});
        }
	},
};